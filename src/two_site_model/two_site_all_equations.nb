(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42478,       1295]
NotebookOptionsPosition[     37047,       1203]
NotebookOutlinePosition[     37453,       1219]
CellTagsIndexPosition[     37410,       1216]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"No", " ", "hills"}], "*)"}]}], "\n", 
 RowBox[{"s", "=", 
  RowBox[{"{", 
   RowBox[{"1", ",", "i", ",", "n", ",", 
    RowBox[{"i", "*", "n"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"b", "=", 
  RowBox[{"{", 
   RowBox[{"1", ",", "\[IndentingNewLine]", 
    RowBox[{"Subscript", "[", 
     RowBox[{"k", ",", "i"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Subscript", "[", 
     RowBox[{"k", ",", "n"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"k", ",", "i"}], "]"}], "*", 
     RowBox[{"Subscript", "[", 
      RowBox[{"k", ",", "n"}], "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"bindingAmt", " ", "=", " ", 
  RowBox[{"s", "*", "b"}]}], "\[IndentingNewLine]", 
 RowBox[{"prob", " ", "=", " ", 
  RowBox[{"bindingAmt", "/", 
   RowBox[{"(", 
    RowBox[{"s", ".", "b"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"tvec", "=", 
  RowBox[{"{", 
   RowBox[{"0", ",", "\[IndentingNewLine]", 
    RowBox[{"Subscript", "[", 
     RowBox[{"t", ",", "i"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Subscript", "[", 
     RowBox[{"t", ",", "n"}], "]"}], ",", "\[IndentingNewLine]", "1"}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.9231458782568707`*^9, 3.92314590668891*^9}, {
  3.92314593669143*^9, 3.923145958900874*^9}, {3.923146152707733*^9, 
  3.923146154017033*^9}, {3.9231462403360033`*^9, 3.923146240416477*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"8fc6e1a6-aaf9-4fb5-83bc-61d1eb486aa3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "i", ",", "n", ",", 
   RowBox[{"i", " ", "n"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.923145879347336*^9, 3.9231459072978773`*^9}, {
   3.9231459373752527`*^9, 3.9231459604563*^9}, 3.923146159114028*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"40acbf76-5392-4809-af0e-ec76f8db332d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   SubscriptBox["k", "i"], ",", 
   SubscriptBox["k", "n"], ",", 
   RowBox[{
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "n"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.923145879347336*^9, 3.9231459072978773`*^9}, {
   3.9231459373752527`*^9, 3.9231459604563*^9}, 3.923146159114994*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"17690ea1-91bf-4d45-8534-9181c13acf53"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"i", " ", 
    SubscriptBox["k", "i"]}], ",", 
   RowBox[{"n", " ", 
    SubscriptBox["k", "n"]}], ",", 
   RowBox[{"i", " ", "n", " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "n"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.923145879347336*^9, 3.9231459072978773`*^9}, {
   3.9231459373752527`*^9, 3.9231459604563*^9}, 3.923146159115843*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"c163651d-777f-4a75-8dca-69e10a5c4ba2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"1", "+", 
     RowBox[{"i", " ", 
      SubscriptBox["k", "i"]}], "+", 
     RowBox[{"n", " ", 
      SubscriptBox["k", "n"]}], "+", 
     RowBox[{"i", " ", "n", " ", 
      SubscriptBox["k", "i"], " ", 
      SubscriptBox["k", "n"]}]}]], ",", 
   FractionBox[
    RowBox[{"i", " ", 
     SubscriptBox["k", "i"]}], 
    RowBox[{"1", "+", 
     RowBox[{"i", " ", 
      SubscriptBox["k", "i"]}], "+", 
     RowBox[{"n", " ", 
      SubscriptBox["k", "n"]}], "+", 
     RowBox[{"i", " ", "n", " ", 
      SubscriptBox["k", "i"], " ", 
      SubscriptBox["k", "n"]}]}]], ",", 
   FractionBox[
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], 
    RowBox[{"1", "+", 
     RowBox[{"i", " ", 
      SubscriptBox["k", "i"]}], "+", 
     RowBox[{"n", " ", 
      SubscriptBox["k", "n"]}], "+", 
     RowBox[{"i", " ", "n", " ", 
      SubscriptBox["k", "i"], " ", 
      SubscriptBox["k", "n"]}]}]], ",", 
   FractionBox[
    RowBox[{"i", " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}], 
    RowBox[{"1", "+", 
     RowBox[{"i", " ", 
      SubscriptBox["k", "i"]}], "+", 
     RowBox[{"n", " ", 
      SubscriptBox["k", "n"]}], "+", 
     RowBox[{"i", " ", "n", " ", 
      SubscriptBox["k", "i"], " ", 
      SubscriptBox["k", "n"]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.923145879347336*^9, 3.9231459072978773`*^9}, {
   3.9231459373752527`*^9, 3.9231459604563*^9}, 3.92314615911691*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"aaf63238-3d94-4492-84c6-2006496560b6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   SubscriptBox["t", "i"], ",", 
   SubscriptBox["t", "n"], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.923145879347336*^9, 3.9231459072978773`*^9}, {
   3.9231459373752527`*^9, 3.9231459604563*^9}, 3.923146159118105*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"b0bb2c9b-d637-49e8-81c2-6ce56ebb1d74"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "=", 
  RowBox[{"prob", ".", "tvec"}]}]], "Input",
 CellChangeTimes->{{3.923146169231498*^9, 3.923146191031687*^9}, {
  3.923146303415526*^9, 3.923146311107548*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"0bb07af1-39ca-4b5b-a1a0-3bbb12087ebc"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"i", " ", "n", " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "n"]}], 
   RowBox[{"1", "+", 
    RowBox[{"i", " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{"i", " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]], "+", 
  FractionBox[
   RowBox[{"i", " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["t", "i"]}], 
   RowBox[{"1", "+", 
    RowBox[{"i", " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{"i", " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SubscriptBox["k", "n"], " ", 
    SubscriptBox["t", "n"]}], 
   RowBox[{"1", "+", 
    RowBox[{"i", " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{"i", " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]]}]], "Output",
 CellChangeTimes->{{3.9231461869495497`*^9, 3.923146193462674*^9}, {
  3.9231463041310987`*^9, 3.9231463115558147`*^9}},
 CellLabel->"Out[92]=",ExpressionUUID->"972c1fdf-362e-4e68-846b-c4b1233b9aec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "=", 
  RowBox[{"Simplify", "[", "f", "]"}]}]], "Input",
 CellChangeTimes->{{3.923146197247542*^9, 3.923146200190896*^9}, {
  3.923146334126802*^9, 
  3.9231463372946444`*^9}},ExpressionUUID->"9a93c34b-f7fa-4173-ad66-\
48fe49be8182"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"i", " ", 
    SubscriptBox["k", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"n", " ", 
       SubscriptBox["k", "n"]}], "+", 
      SubscriptBox["t", "i"]}], ")"}]}], "+", 
   RowBox[{"n", " ", 
    SubscriptBox["k", "n"], " ", 
    SubscriptBox["t", "n"]}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"i", " ", 
      SubscriptBox["k", "i"]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"n", " ", 
      SubscriptBox["k", "n"]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.923146201537877*^9, 3.9231463208264513`*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"c238f8fe-060e-4641-8480-77e003519e96"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"prob", ".", "tvec"}], "//", "TeXForm"}]], "Input",
 CellChangeTimes->{{3.9231462797669287`*^9, 3.92314628164781*^9}, {
  3.923146323431157*^9, 3.923146323735075*^9}, {3.9231463552154417`*^9, 
  3.923146355606567*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"3f8f3374-6993-4be2-8770-e283b4298f25"],

Cell["\<\
\\frac{n k_n t_n}{i n k_i k_n+i k_i+n k_n+1}+\\frac{i k_i t_i}{i n k_i
   k_n+i k_i+n k_n+1}+\\frac{i n k_i k_n}{i n k_i k_n+i k_i+n k_n+1}\
\>", "Output",
 CellChangeTimes->{
  3.9231462821695557`*^9, {3.9231463272011347`*^9, 3.9231463560033283`*^9}},
 CellLabel->
  "Out[96]//TeXForm=",ExpressionUUID->"7c30a03c-030b-408b-a492-e0de0b329a6e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "//", "TeXForm"}]], "Input",
 CellChangeTimes->{{3.923146339623433*^9, 3.923146349406989*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"6f6e07ca-8aa8-4d8f-a008-6df322545a7f"],

Cell["\<\
\\frac{i k_i \\left(t_i+n k_n\\right)+n k_n t_n}{\\left(i k_i+1\\right)
   \\left(n k_n+1\\right)}\
\>", "Output",
 CellChangeTimes->{3.923146351057845*^9},
 CellLabel->
  "Out[95]//TeXForm=",ExpressionUUID->"6f205dad-7e57-4ab4-9f9a-84174d7d1cc5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"prob", " ", "//", "MatrixForm"}], "//", "TeXForm"}]], "Input",
 CellChangeTimes->{{3.923146923341435*^9, 3.923146928605157*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"89cf5efd-0190-417b-9388-dc9148128f1c"],

Cell["\<\
\\left(
\\begin{array}{c}
 \\frac{1}{i n k_i k_n+i k_i+n k_n+1} \\\\
 \\frac{i k_i}{i n k_i k_n+i k_i+n k_n+1} \\\\
 \\frac{n k_n}{i n k_i k_n+i k_i+n k_n+1} \\\\
 \\frac{i n k_i k_n}{i n k_i k_n+i k_i+n k_n+1} \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{3.9231469290498323`*^9},
 CellLabel->
  "Out[97]//TeXForm=",ExpressionUUID->"f8c9d0a8-3b8a-4966-beac-dab79a8161fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"probIRF", "=", 
  RowBox[{
   RowBox[{"prob", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "+", 
   RowBox[{"prob", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"probNFkB", "=", 
  RowBox[{
   RowBox[{"prob", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "+", 
   RowBox[{"prob", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.923153413077854*^9, 3.923153434623516*^9}, {
  3.923153494029787*^9, 3.923153509933404*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"177928c1-e662-4fb9-b511-8636fc3bb793"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"i", " ", 
    SubscriptBox["k", "i"]}], 
   RowBox[{"1", "+", 
    RowBox[{"i", " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{"i", " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]], "+", 
  FractionBox[
   RowBox[{"i", " ", "n", " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "n"]}], 
   RowBox[{"1", "+", 
    RowBox[{"i", " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{"i", " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]]}]], "Output",
 CellChangeTimes->{3.923153510476077*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"9c631c6c-8e44-4897-89c4-f0317e2cdc0b"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"n", " ", 
    SubscriptBox["k", "n"]}], 
   RowBox[{"1", "+", 
    RowBox[{"i", " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{"i", " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]], "+", 
  FractionBox[
   RowBox[{"i", " ", "n", " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "n"]}], 
   RowBox[{"1", "+", 
    RowBox[{"i", " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{"i", " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]]}]], "Output",
 CellChangeTimes->{3.9231535104775877`*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"2debfbe3-adf2-41a1-b099-c381555bec26"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"probIRF", " ", "//", "Simplify"}], "//", " ", "TeXForm"}]], "Input",\

 CellChangeTimes->{{3.923153544588971*^9, 3.923153559396854*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"dcca7d94-62fa-4ebe-9f71-4bc828df44f3"],

Cell["\\frac{i k_i}{i k_i+1}", "Output",
 CellChangeTimes->{{3.9231535506809273`*^9, 3.923153559832344*^9}},
 CellLabel->
  "Out[101]//TeXForm=",ExpressionUUID->"699677f4-41db-4804-9b0c-f6bce15fccb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"probNFkB", "//", "Simplify"}], "//", "TeXForm"}]], "Input",
 CellChangeTimes->{{3.923153598300569*^9, 3.9231536015812473`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"c06d43f2-f600-4e5c-953f-53d10ef7f070"],

Cell["\\frac{n k_n}{n k_n+1}", "Output",
 CellChangeTimes->{3.923153602117659*^9},
 CellLabel->
  "Out[102]//TeXForm=",ExpressionUUID->"1f6f2b1c-bdae-4ffa-a1d4-563e2b5d4acb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"all", " ", "hills"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"s", "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "i", ",", "n", ",", 
      RowBox[{"i", "*", "n"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"b", "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{"k", ",", "i"}], "]"}], "*", 
       RowBox[{"i", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"h", ",", "i"}], "]"}], "-", "1"}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{"k", ",", "n"}], "]"}], "*", 
       RowBox[{"n", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"h", ",", "n"}], "]"}], "-", "1"}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{"k", ",", "i"}], "]"}], "*", 
       RowBox[{"Subscript", "[", 
        RowBox[{"k", ",", "n"}], "]"}], "*", 
       RowBox[{"i", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"h", ",", "i"}], "]"}], "-", "1"}], ")"}]}], "*", 
       RowBox[{"n", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"h", ",", "n"}], "]"}], "-", "1"}], ")"}]}]}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"bindingAmt", " ", "=", " ", 
    RowBox[{"s", "*", "b"}]}], "\[IndentingNewLine]", 
   RowBox[{"prob", " ", "=", " ", 
    RowBox[{"bindingAmt", "/", 
     RowBox[{"(", 
      RowBox[{"s", ".", "b"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"probIRF", "=", 
    RowBox[{
     RowBox[{"prob", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "+", 
     RowBox[{"prob", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"probNFkB", "=", 
    RowBox[{
     RowBox[{"prob", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "+", 
     RowBox[{"prob", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}]}]}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"59060f37-7a54-4656-b067-ab03f6f8b9b3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "i", ",", "n", ",", 
   RowBox[{"i", " ", "n"}]}], "}"}]], "Output",
 CellChangeTimes->{3.923409122096304*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"b0e969ff-0a63-4826-95db-b33d75a433f1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{
    SuperscriptBox["i", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SubscriptBox["h", "i"]}]], " ", 
    SubscriptBox["k", "i"]}], ",", 
   RowBox[{
    SuperscriptBox["n", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SubscriptBox["h", "n"]}]], " ", 
    SubscriptBox["k", "n"]}], ",", 
   RowBox[{
    SuperscriptBox["i", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SubscriptBox["h", "i"]}]], " ", 
    SuperscriptBox["n", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SubscriptBox["h", "n"]}]], " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "n"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.923409122097803*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"0c8ee892-bb6d-4a8d-a024-5bb9257cb975"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{
    SuperscriptBox["i", 
     SubscriptBox["h", "i"]], " ", 
    SubscriptBox["k", "i"]}], ",", 
   RowBox[{
    SuperscriptBox["n", 
     SubscriptBox["h", "n"]], " ", 
    SubscriptBox["k", "n"]}], ",", 
   RowBox[{
    SuperscriptBox["i", 
     SubscriptBox["h", "i"]], " ", 
    SuperscriptBox["n", 
     SubscriptBox["h", "n"]], " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "n"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.923409122101221*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"90b7353b-0f5a-4874-954f-e3cd3b975281"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"1", "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", 
      SubscriptBox["k", "i"]}], "+", 
     RowBox[{
      SuperscriptBox["n", 
       SubscriptBox["h", "n"]], " ", 
      SubscriptBox["k", "n"]}], "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", 
      SuperscriptBox["n", 
       SubscriptBox["h", "n"]], " ", 
      SubscriptBox["k", "i"], " ", 
      SubscriptBox["k", "n"]}]}]], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], 
    RowBox[{"1", "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", 
      SubscriptBox["k", "i"]}], "+", 
     RowBox[{
      SuperscriptBox["n", 
       SubscriptBox["h", "n"]], " ", 
      SubscriptBox["k", "n"]}], "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", 
      SuperscriptBox["n", 
       SubscriptBox["h", "n"]], " ", 
      SubscriptBox["k", "i"], " ", 
      SubscriptBox["k", "n"]}]}]], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "n"]}], 
    RowBox[{"1", "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", 
      SubscriptBox["k", "i"]}], "+", 
     RowBox[{
      SuperscriptBox["n", 
       SubscriptBox["h", "n"]], " ", 
      SubscriptBox["k", "n"]}], "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", 
      SuperscriptBox["n", 
       SubscriptBox["h", "n"]], " ", 
      SubscriptBox["k", "i"], " ", 
      SubscriptBox["k", "n"]}]}]], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}], 
    RowBox[{"1", "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", 
      SubscriptBox["k", "i"]}], "+", 
     RowBox[{
      SuperscriptBox["n", 
       SubscriptBox["h", "n"]], " ", 
      SubscriptBox["k", "n"]}], "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", 
      SuperscriptBox["n", 
       SubscriptBox["h", "n"]], " ", 
      SubscriptBox["k", "i"], " ", 
      SubscriptBox["k", "n"]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.923409122102377*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"cb987b48-9acf-4e24-82c2-c30addbcb59d"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["i", 
     SubscriptBox["h", "i"]], " ", 
    SubscriptBox["k", "i"]}], 
   RowBox[{"1", "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["i", 
     SubscriptBox["h", "i"]], " ", 
    SuperscriptBox["n", 
     SubscriptBox["h", "n"]], " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "n"]}], 
   RowBox[{"1", "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]]}]], "Output",
 CellChangeTimes->{3.92340912210356*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"65997f1f-f4f6-489a-a65e-c5c92f0ea66a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["n", 
     SubscriptBox["h", "n"]], " ", 
    SubscriptBox["k", "n"]}], 
   RowBox[{"1", "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["i", 
     SubscriptBox["h", "i"]], " ", 
    SuperscriptBox["n", 
     SubscriptBox["h", "n"]], " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "n"]}], 
   RowBox[{"1", "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]]}]], "Output",
 CellChangeTimes->{3.923409122104621*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"878504af-40fb-49d0-bbef-1f6fee8848ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"tvec", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "\[IndentingNewLine]", 
    RowBox[{"Subscript", "[", 
     RowBox[{"t", ",", "i"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Subscript", "[", 
     RowBox[{"t", ",", "n"}], "]"}], ",", "\[IndentingNewLine]", "1"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"f", "=", 
  RowBox[{"prob", ".", "tvec"}]}]}], "Input",
 CellChangeTimes->{{3.9234091634068403`*^9, 3.9234091777851686`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"79b8dc74-81ea-45c6-a769-1f01bdb4507c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   SubscriptBox["t", "i"], ",", 
   SubscriptBox["t", "n"], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.923409179458053*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"a456d15c-5120-446d-8773-e9cee741727f"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["i", 
     SubscriptBox["h", "i"]], " ", 
    SuperscriptBox["n", 
     SubscriptBox["h", "n"]], " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "n"]}], 
   RowBox[{"1", "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["i", 
     SubscriptBox["h", "i"]], " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["t", "i"]}], 
   RowBox[{"1", "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["n", 
     SubscriptBox["h", "n"]], " ", 
    SubscriptBox["k", "n"], " ", 
    SubscriptBox["t", "n"]}], 
   RowBox[{"1", "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SuperscriptBox["n", 
      SubscriptBox["h", "n"]], " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]]}]], "Output",
 CellChangeTimes->{3.923409179462222*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"0fbf6f98-6fc9-404f-9051-9939f69ba399"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "//", "Simplify"}], "//", "TeXForm"}]], "Input",
 CellChangeTimes->{{3.9234092040471363`*^9, 3.923409204549944*^9}, {
  3.9234093074856033`*^9, 3.923409320653529*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"7179c558-60d1-400f-a227-eab4f8df4b79"],

Cell["\<\
\\frac{i^{h_i} k_i \\left(n^{h_n} k_n+t_i\\right)+n^{h_n} k_n \
t_n}{\\left(i^{h_i}
   k_i+1\\right) \\left(n^{h_n} k_n+1\\right)}\
\>", "Output",
 CellChangeTimes->{{3.923409309409069*^9, 3.9234093212054567`*^9}},
 CellLabel->
  "Out[11]//TeXForm=",ExpressionUUID->"b15cfe16-f2c9-4d48-8009-1dbfe5b770f9"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.923409526335166*^9, 
  3.923409592540514*^9}},ExpressionUUID->"d26157a1-3dcf-476c-9941-\
4954ad7b5c29"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"only", " ", "hill", " ", "on", " ", "IRF"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"s", "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "i", ",", "n", ",", 
      RowBox[{"i", "*", "n"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"b", "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{"k", ",", "i"}], "]"}], "*", 
       RowBox[{"i", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"h", ",", "i"}], "]"}], "-", "1"}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{"k", ",", "n"}], "]"}], "*", 
       RowBox[{"n", "^", 
        RowBox[{"(", 
         RowBox[{"1", "-", "1"}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{"k", ",", "i"}], "]"}], "*", 
       RowBox[{"Subscript", "[", 
        RowBox[{"k", ",", "n"}], "]"}], "*", 
       RowBox[{"i", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"h", ",", "i"}], "]"}], "-", "1"}], ")"}]}], "*", 
       RowBox[{"n", "^", 
        RowBox[{"(", 
         RowBox[{"1", "-", "1"}], ")"}]}]}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"bindingAmt", " ", "=", " ", 
    RowBox[{"s", "*", "b"}]}], "\[IndentingNewLine]", 
   RowBox[{"prob", " ", "=", " ", 
    RowBox[{"bindingAmt", "/", 
     RowBox[{"(", 
      RowBox[{"s", ".", "b"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"probIRF", "=", 
    RowBox[{
     RowBox[{"prob", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "+", 
     RowBox[{"prob", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"probNFkB", "=", 
    RowBox[{
     RowBox[{"prob", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "+", 
     RowBox[{"prob", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.923409600948299*^9, 3.923409643820606*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"55cc12fb-bb47-4da4-ad52-ddce15c33ba9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "i", ",", "n", ",", 
   RowBox[{"i", " ", "n"}]}], "}"}]], "Output",
 CellChangeTimes->{3.923409644762066*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"d2079a10-d358-4234-a408-6adf922ad4f2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{
    SuperscriptBox["i", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SubscriptBox["h", "i"]}]], " ", 
    SubscriptBox["k", "i"]}], ",", 
   SubscriptBox["k", "n"], ",", 
   RowBox[{
    SuperscriptBox["i", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SubscriptBox["h", "i"]}]], " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "n"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.923409644765646*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"077330b7-afad-4b35-b6e7-ebc87b84fced"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{
    SuperscriptBox["i", 
     SubscriptBox["h", "i"]], " ", 
    SubscriptBox["k", "i"]}], ",", 
   RowBox[{"n", " ", 
    SubscriptBox["k", "n"]}], ",", 
   RowBox[{
    SuperscriptBox["i", 
     SubscriptBox["h", "i"]], " ", "n", " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "n"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.923409644768078*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"7c2368fd-cc16-4399-8b6e-8af7b61d3842"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"1", "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", 
      SubscriptBox["k", "i"]}], "+", 
     RowBox[{"n", " ", 
      SubscriptBox["k", "n"]}], "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", "n", " ", 
      SubscriptBox["k", "i"], " ", 
      SubscriptBox["k", "n"]}]}]], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], 
    RowBox[{"1", "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", 
      SubscriptBox["k", "i"]}], "+", 
     RowBox[{"n", " ", 
      SubscriptBox["k", "n"]}], "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", "n", " ", 
      SubscriptBox["k", "i"], " ", 
      SubscriptBox["k", "n"]}]}]], ",", 
   FractionBox[
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], 
    RowBox[{"1", "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", 
      SubscriptBox["k", "i"]}], "+", 
     RowBox[{"n", " ", 
      SubscriptBox["k", "n"]}], "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", "n", " ", 
      SubscriptBox["k", "i"], " ", 
      SubscriptBox["k", "n"]}]}]], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}], 
    RowBox[{"1", "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", 
      SubscriptBox["k", "i"]}], "+", 
     RowBox[{"n", " ", 
      SubscriptBox["k", "n"]}], "+", 
     RowBox[{
      SuperscriptBox["i", 
       SubscriptBox["h", "i"]], " ", "n", " ", 
      SubscriptBox["k", "i"], " ", 
      SubscriptBox["k", "n"]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.923409644771192*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"556271a5-ad78-4005-824d-20aba437784a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["i", 
     SubscriptBox["h", "i"]], " ", 
    SubscriptBox["k", "i"]}], 
   RowBox[{"1", "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["i", 
     SubscriptBox["h", "i"]], " ", "n", " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "n"]}], 
   RowBox[{"1", "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]]}]], "Output",
 CellChangeTimes->{3.9234096447742558`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"f9e4a4b9-8b99-4f8b-b802-b40cdf9138f9"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"n", " ", 
    SubscriptBox["k", "n"]}], 
   RowBox[{"1", "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["i", 
     SubscriptBox["h", "i"]], " ", "n", " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "n"]}], 
   RowBox[{"1", "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]]}]], "Output",
 CellChangeTimes->{3.923409644776909*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"f745549f-25ae-4326-abfb-da578d760d51"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"tvec", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", "\[IndentingNewLine]", 
    RowBox[{"Subscript", "[", 
     RowBox[{"t", ",", "i"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Subscript", "[", 
     RowBox[{"t", ",", "n"}], "]"}], ",", "\[IndentingNewLine]", "1"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"f", "=", 
  RowBox[{"prob", ".", "tvec"}]}]}], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"a18e98dc-abd1-4c12-9294-51f4b9e7f1ee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   SubscriptBox["t", "i"], ",", 
   SubscriptBox["t", "n"], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.9234096608505287`*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"cfacfa67-1f85-49c0-bcec-c1527a3f0b39"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["i", 
     SubscriptBox["h", "i"]], " ", "n", " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["k", "n"]}], 
   RowBox[{"1", "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["i", 
     SubscriptBox["h", "i"]], " ", 
    SubscriptBox["k", "i"], " ", 
    SubscriptBox["t", "i"]}], 
   RowBox[{"1", "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SubscriptBox["k", "n"], " ", 
    SubscriptBox["t", "n"]}], 
   RowBox[{"1", "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", 
     SubscriptBox["k", "i"]}], "+", 
    RowBox[{"n", " ", 
     SubscriptBox["k", "n"]}], "+", 
    RowBox[{
     SuperscriptBox["i", 
      SubscriptBox["h", "i"]], " ", "n", " ", 
     SubscriptBox["k", "i"], " ", 
     SubscriptBox["k", "n"]}]}]]}]], "Output",
 CellChangeTimes->{3.923409660855812*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"1e80221c-042c-4cda-aba5-132ee3feb668"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "//", "Simplify"}], "//", "TeXForm"}]], "Input",
 CellChangeTimes->{{3.923409708589364*^9, 3.9234097271239853`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"479223f9-d00c-4959-b9cb-f836e3739d47"],

Cell["\<\
\\frac{i^{h_i} k_i \\left(t_i+n k_n\\right)+n k_n t_n}{\\left(n k_n+1\\right)
   \\left(i^{h_i} k_i+1\\right)}\
\>", "Output",
 CellChangeTimes->{{3.923409711357729*^9, 3.923409727622123*^9}},
 CellLabel->
  "Out[24]//TeXForm=",ExpressionUUID->"09f6b5a1-a962-45a8-a3f6-b75b53c7453b"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.92340973941158*^9, 
  3.9234097678349133`*^9}},ExpressionUUID->"b047a039-2cf6-4d4a-9d09-\
2d5ece9ec3a5"]
},
WindowSize->{755.25, 765},
WindowMargins->{{-1442.25, Automatic}, {42.75, Automatic}},
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d6b1d701-bc91-44cc-9122-78c9f3afe393"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1620, 38, 270, "Input",ExpressionUUID->"8fc6e1a6-aaf9-4fb5-83bc-61d1eb486aa3"],
Cell[2203, 62, 336, 6, 35, "Output",ExpressionUUID->"40acbf76-5392-4809-af0e-ec76f8db332d"],
Cell[2542, 70, 430, 10, 35, "Output",ExpressionUUID->"17690ea1-91bf-4d45-8534-9181c13acf53"],
Cell[2975, 82, 500, 12, 35, "Output",ExpressionUUID->"c163651d-777f-4a75-8dca-69e10a5c4ba2"],
Cell[3478, 96, 1582, 48, 106, "Output",ExpressionUUID->"aaf63238-3d94-4492-84c6-2006496560b6"],
Cell[5063, 146, 358, 7, 33, "Output",ExpressionUUID->"b0bb2c9b-d637-49e8-81c2-6ce56ebb1d74"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5458, 158, 272, 5, 29, "Input",ExpressionUUID->"0bb07af1-39ca-4b5b-a1a0-3bbb12087ebc"],
Cell[5733, 165, 1296, 40, 58, "Output",ExpressionUUID->"972c1fdf-362e-4e68-846b-c4b1233b9aec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7066, 210, 261, 6, 29, "Input",ExpressionUUID->"9a93c34b-f7fa-4173-ad66-48fe49be8182"],
Cell[7330, 218, 712, 23, 61, "Output",ExpressionUUID->"c238f8fe-060e-4641-8480-77e003519e96"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8079, 246, 331, 6, 29, "Input",ExpressionUUID->"3f8f3374-6993-4be2-8770-e283b4298f25"],
Cell[8413, 254, 353, 7, 65, "Output",ExpressionUUID->"7c30a03c-030b-408b-a492-e0de0b329a6e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8803, 266, 201, 3, 29, "Input",ExpressionUUID->"6f6e07ca-8aa8-4d8f-a008-6df322545a7f"],
Cell[9007, 271, 257, 6, 65, "Output",ExpressionUUID->"6f205dad-7e57-4ab4-9f9a-84174d7d1cc5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9301, 282, 242, 4, 29, "Input",ExpressionUUID->"89cf5efd-0190-417b-9388-dc9148128f1c"],
Cell[9546, 288, 398, 12, 173, "Output",ExpressionUUID->"f8c9d0a8-3b8a-4966-beac-dab79a8161fe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9981, 305, 582, 15, 50, "Input",ExpressionUUID->"177928c1-e662-4fb9-b511-8636fc3bb793"],
Cell[10566, 322, 831, 26, 58, "Output",ExpressionUUID->"9c631c6c-8e44-4897-89c4-f0317e2cdc0b"],
Cell[11400, 350, 833, 26, 58, "Output",ExpressionUUID->"2debfbe3-adf2-41a1-b099-c381555bec26"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12270, 381, 254, 6, 29, "Input",ExpressionUUID->"dcca7d94-62fa-4ebe-9f71-4bc828df44f3"],
Cell[12527, 389, 200, 3, 47, "Output",ExpressionUUID->"699677f4-41db-4804-9b0c-f6bce15fccb1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12764, 397, 245, 5, 29, "Input",ExpressionUUID->"c06d43f2-f600-4e5c-953f-53d10ef7f070"],
Cell[13012, 404, 174, 3, 47, "Output",ExpressionUUID->"1f6f2b1c-bdae-4ffa-a1d4-563e2b5d4acb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13223, 412, 2159, 62, 190, "Input",ExpressionUUID->"59060f37-7a54-4656-b067-ab03f6f8b9b3"],
Cell[15385, 476, 237, 5, 35, "Output",ExpressionUUID->"b0e969ff-0a63-4826-95db-b33d75a433f1"],
Cell[15625, 483, 801, 27, 35, "Output",ExpressionUUID->"0c8ee892-bb6d-4a8d-a024-5bb9257cb975"],
Cell[16429, 512, 605, 19, 35, "Output",ExpressionUUID->"90b7353b-0f5a-4874-954f-e3cd3b975281"],
Cell[17037, 533, 2576, 87, 106, "Output",ExpressionUUID->"cb987b48-9acf-4e24-82c2-c30addbcb59d"],
Cell[19616, 622, 1406, 48, 58, "Output",ExpressionUUID->"65997f1f-f4f6-489a-a65e-c5c92f0ea66a"],
Cell[21025, 672, 1407, 48, 58, "Output",ExpressionUUID->"878504af-40fb-49d0-bbef-1f6fee8848ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22469, 725, 559, 12, 110, "Input",ExpressionUUID->"79b8dc74-81ea-45c6-a769-1f01bdb4507c"],
Cell[23031, 739, 259, 6, 33, "Output",ExpressionUUID->"a456d15c-5120-446d-8773-e9cee741727f"],
Cell[23293, 747, 2056, 71, 58, "Output",ExpressionUUID->"0fbf6f98-6fc9-404f-9051-9939f69ba399"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25386, 823, 285, 5, 29, "Input",ExpressionUUID->"7179c558-60d1-400f-a227-eab4f8df4b79"],
Cell[25674, 830, 315, 7, 65, "Output",ExpressionUUID->"b15cfe16-f2c9-4d48-8009-1dbfe5b770f9"]
}, Open  ]],
Cell[26004, 840, 152, 3, 29, "Input",ExpressionUUID->"d26157a1-3dcf-476c-9941-4954ad7b5c29"],
Cell[CellGroupData[{
Cell[26181, 847, 2096, 59, 170, "Input",ExpressionUUID->"55cc12fb-bb47-4da4-ad52-ddce15c33ba9"],
Cell[28280, 908, 238, 5, 35, "Output",ExpressionUUID->"d2079a10-d358-4234-a408-6adf922ad4f2"],
Cell[28521, 915, 567, 18, 35, "Output",ExpressionUUID->"077330b7-afad-4b35-b6e7-ebc87b84fced"],
Cell[29091, 935, 504, 15, 35, "Output",ExpressionUUID->"7c2368fd-cc16-4399-8b6e-8af7b61d3842"],
Cell[29598, 952, 2031, 67, 106, "Output",ExpressionUUID->"556271a5-ad78-4005-824d-20aba437784a"],
Cell[31632, 1021, 1147, 38, 58, "Output",ExpressionUUID->"f9e4a4b9-8b99-4f8b-b802-b40cdf9138f9"],
Cell[32782, 1061, 1094, 36, 58, "Output",ExpressionUUID->"f745549f-25ae-4326-abfb-da578d760d51"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33913, 1102, 490, 11, 110, "Input",ExpressionUUID->"a18e98dc-abd1-4c12-9294-51f4b9e7f1ee"],
Cell[34406, 1115, 262, 6, 33, "Output",ExpressionUUID->"cfacfa67-1f85-49c0-bcec-c1527a3f0b39"],
Cell[34671, 1123, 1637, 55, 58, "Output",ExpressionUUID->"1e80221c-042c-4cda-aba5-132ee3feb668"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36345, 1183, 234, 4, 29, "Input",ExpressionUUID->"479223f9-d00c-4959-b9cb-f836e3739d47"],
Cell[36582, 1189, 293, 6, 65, "Output",ExpressionUUID->"09f6b5a1-a962-45a8-a3f6-b75b53c7453b"]
}, Open  ]],
Cell[36890, 1198, 153, 3, 29, "Input",ExpressionUUID->"b047a039-2cf6-4d4a-9d09-2d5ece9ec3a5"]
}
]
*)

