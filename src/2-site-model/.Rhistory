source('~/Dropbox/Current/4. IFN/IFNb_Expression_2015/Models/new_2/resid_violin_plot.R')
source('~/Dropbox/Current/4. IFN/IFNb_Expression_2015/Models/new_2/resid_violin_plot.R')
filename="residue_subset1"
rmsd_resid <- read.csv(file=paste("./data/",filename,".csv",sep=""),header = F)
names(rmsd_resid)<-c(sapply(X = 1:8,function(x)paste('resid',x)),'rmsd')
names(rmsd_resid)
library(vioplot)
library(RColorBrewer)
rmsd_resid$rmsd_facor <- cut(rmsd_resid$rmsd,5)
levels(rmsd_resid$rmsd_facor)<-c("0",levels(rmsd_resid$rmsd_facor))
# add a level to avoid white color in brewer.pal
plot(0, type="n", xlab="Resdi Value", ylab="Resid Index", xlim=c(-.4, .4), ylim=c(0.5, 8.5),yaxt="n")
axis(2,at=1:8)
rect(-.2,0,0.2,9,col="gray90",lty = 2,xlab='value',ylab='resid index')
tmp<-sapply(1:8,function(x) points(rmsd_resid[,x],jitter(rep(x,292),amount = 0.4),
pch=16,cex=.4,col=rev(brewer.pal(6,"Greens"))[rmsd_resid$rmsd_facor]))
dim(rmsd_resid)
tmp<-sapply(1:8,function(x) points(rmsd_resid[,x],jitter(rep(x,dim(rmsd_resid)[1]),amount = 0.4),
pch=16,cex=.4,col=rev(brewer.pal(6,"Greens"))[rmsd_resid$rmsd_facor]))
vioplot(rmsd_resid[,1],rmsd_resid[,2],rmsd_resid[,3],rmsd_resid[,4],
rmsd_resid[,5],rmsd_resid[,6],rmsd_resid[,7],rmsd_resid[,8],
ylim=c(-.4,.4),col=NA,horizontal=T,add=T,colMed="blue")#,)
lines(c(0, 0),c(0, 9),lty=2,font=2)
text(0.22,7.2,"RMSD",adj = c(0,0)) # left algin
legend(0.22,7,legend=levels(rmsd_resid$rmsd_facor)[2:6],pch=16,col= rev(brewer.pal(6,"Greens")[2:6]))##
dev.off()
system(paste("open ",filename,".pdf",sep=""))
source('~/Dropbox/Current/4. IFN/IFNb_Expression_2015/Models/new_2_tVectorModel/resid_violin_plot.R', echo=TRUE)
plot_resid_violin<- function(filename){
rmsd_resid <- read.csv(file=paste("./data/",filename,".csv",sep=""),header = F)
names(rmsd_resid)<-c(sapply(X = 1:8,function(x)paste('resid',x)),'rmsd')
names(rmsd_resid)
# ref: http://f.dataguru.cn/thread-31806-1-1.html
# eg:
#require(beeswarm)
#data(breast)
#head(breast)
#beeswarm(time_survival ~ event_survival, data = breast,method = 'swarm',pch = 16,
#         pwcol = as.numeric(ER),xlab = '',
#         ylab = 'Follow-up time (months)',labels = c('Censored', 'Metastasis'))
#boxplot(time_survival ~ event_survival,data = breast, add = T,names = c("",""),col="#0000ff22")
#install.packages("beeswarm")
#require(beeswarm)
#beeswarm(time_survival ~ event_survival, data = breast,method = 'swarm',pch = 16,
#         pwcol = as.numeric(ER),xlab = '',
#         ylab = 'Follow-up time (months)',labels = c('Censored', 'Metastasis'))
#boxplot(time_survival ~ event_survival,data = breast, add = T,names = c("",""),col="#0000ff22")
#beeswarm(rmsd_resid[,1:8],method="square")
## vioplot with jitter scatter
#install.packages("vioplot")
library(vioplot)
library(RColorBrewer)
rmsd_resid$rmsd_facor <- cut(rmsd_resid$rmsd,5)
levels(rmsd_resid$rmsd_facor)<-c("0",levels(rmsd_resid$rmsd_facor))
# add a level to avoid white color in brewer.pal
pdf(file = paste(filename,".pdf",sep=""),width = 4,height = 3)
par(mar=c(4, 4, 1, 1) + 0.1)
plot(0, type="n", xlab="Resdi Value", ylab="Resid Index", xlim=c(-.2, .2), ylim=c(0.5, 8.5),yaxt="n")
axis(2,at=1:8)
rect(-.125,0,0.125,9,col="gray90",lty = 2,xlab='value',ylab='resid index')
tmp<-sapply(1:8,function(x) points(rmsd_resid[,x],jitter(rep(x,dim(rmsd_resid)[1]),amount = 0.4),
pch=16,cex=.4,col=rev(brewer.pal(6,"Greens"))[rmsd_resid$rmsd_facor]))
vioplot(rmsd_resid[,1],rmsd_resid[,2],rmsd_resid[,3],rmsd_resid[,4],
rmsd_resid[,5],rmsd_resid[,6],rmsd_resid[,7],rmsd_resid[,8],
ylim=c(-.4,.4),col=NA,horizontal=T,add=T,colMed="blue")#,)
lines(c(0, 0),c(0, 9),lty=2,font=2)
text(0.22,7.2,"RMSD",adj = c(0,0)) # left algin
legend(0.22,7,legend=levels(rmsd_resid$rmsd_facor)[2:6],pch=16,col= rev(brewer.pal(6,"Greens")[2:6]))##
dev.off()
system(paste("open ",filename,".pdf",sep=""))
}
plot_resid_violin("plot_resid_violin")
plot_resid_violin("03Model_t5")
?vioplot
filename <- "03Model_t5"
rmsd_resid <- read.csv(file=paste("./data/",filename,".csv",sep=""),header = F)
names(rmsd_resid)<-c(sapply(X = 1:8,function(x) paste('resid',x)),'rmsd')
names(rmsd_resid)
library(vioplot)
library(RColorBrewer)
rmsd_resid$rmsd_facor <- cut(rmsd_resid$rmsd,5)
levels(rmsd_resid$rmsd_facor)<-c("0",levels(rmsd_resid$rmsd_facor))
par(mar=c(4, 4, 1, 1) + 0.1)
plot(0, type="n", xlab="Resdi Value", ylab="Resid Index", xlim=c(-.2, .2), ylim=c(0.5, 8.5),yaxt="n")
axis(2,at=1:8)
rect(-.125,0,0.125,9,col="gray90",lty = 2,xlab='value',ylab='resid index')
tmp<-sapply(1:8,function(x) points(rmsd_resid[,x],jitter(rep(x,dim(rmsd_resid)[1]),amount = 0.4),
pch=16,cex=.4,col=rev(brewer.pal(6,"Greens"))[rmsd_resid$rmsd_facor]))
vioplot(rmsd_resid[,1],rmsd_resid[,2],rmsd_resid[,3],rmsd_resid[,4],
rmsd_resid[,5],rmsd_resid[,6],rmsd_resid[,7],rmsd_resid[,8],
ylim=c(-.4,.4),col=NA,horizontal=T,add=T,colMed="blue")#,)
head(rmsd_resid)
rmsd_resid
rmsd_resid$rmsd_facor
rmsd_resid[,1]
vioplot(rmsd_resid[,1],rmsd_resid[,2],rmsd_resid[,3],rmsd_resid[,4],
rmsd_resid[,5],rmsd_resid[,6],rmsd_resid[,7],rmsd_resid[,8],
ylim=c(-.4,.4),col=NA,horizontal=T,add=T,colMed="blue")#,)
vioplot
head(rmsd_resid)
summry(rmsd_resid)
summary(rmsd_resid)
vioplot(rmsd_resid[,1],rmsd_resid[,2],rmsd_resid[,3],rmsd_resid[,4],
rmsd_resid[,5],rmsd_resid[,6],rmsd_resid[,7],#rmsd_resid[,8],
ylim=c(-.4,.4),col=NA,horizontal=T,add=T,colMed="blue")#,)
dev.off
dev.off()
vioplot(rmsd_resid[,1],rmsd_resid[,2],rmsd_resid[,3],rmsd_resid[,4],
rmsd_resid[,5],rmsd_resid[,6],rmsd_resid[,7],rmsd_resid[,8],
ylim=c(-.4,.4),col=NA,horizontal=T,add=T,colMed="blue")#,)
vioplot
